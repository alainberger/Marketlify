<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Marketlify</title>
  <meta name="description" content="Marketlify ‚Äî R√©serve tes billets de concerts et spectacles rapidement. Promotions, prochains √©v√©nements et billets √©lectroniques." />
  <meta name="keywords" content="Marketlify, billets, concerts, spectacles, tickets, √©v√©nements" />
  <link rel="icon" href="https://i.postimg.cc/KjLQ8q3b/Background-Eraser.png" type="image/png">
  <meta property="og:title" content="Marketlify ‚Äî Billets de concerts & spectacles" />
  <meta property="og:description" content="R√©serve facilement tes billets de concerts et spectacles. Promotions & nouveaut√©s." />
  <meta property="og:image" content="https://i.postimg.cc/KjLQ8q3b/Background-Eraser.png" />
  <meta property="og:type" content="website" />

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Montserrat:wght@600;700&display=swap" rel="stylesheet">

  <style>
    /* ---------------- Reset & root ---------------- */
    *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
    :root{
      --accent:#f57a02;
      --accent-2:#94c9e9;
      --glass:rgba(255,255,255,0.08);
      --bg:#071124; /* dark fallback used when dark mode enabled */
      --card-bg:#ffffff;
      --text-dark:#0f1722;
      --muted:#6b7280;
      --radius:12px;
      --maxw:1100px;
      --mobile-padding:14px;
    }
    html,body{height:100%;-webkit-font-smoothing:antialiased;font-family:'Inter',sans-serif;background:linear-gradient(180deg, rgba(245,87,2,0.12), rgba(148,201,233,0.08));color:var(--text-dark);overflow-x:hidden}
    body{margin:0;padding:0;min-height:100vh}
    .app{max-width:var(--maxw);margin:0 auto;padding:var(--mobile-padding)}

    /* ---------------- Header ---------------- */
    header.app-header{display:flex;align-items:center;justify-content:space-between;gap:10px;padding:8px 0;position:sticky;top:0;background:rgba(255,255,255,0.02);backdrop-filter:blur(6px);z-index:1200}
    .brand{display:flex;align-items:center;gap:10px}
    .brand img{height:44px;width:auto}
    .brand h1{font-family:'Montserrat',sans-serif;font-size:1.05rem;color:var(--text-dark)}
    .hamburger{display:flex;flex-direction:column;gap:3px;cursor:pointer}
    .hamburger span{width:22px;height:2px;background:var(--text-dark);display:block;border-radius:2px}

    /* ---------------- Search bar (mobile-first) ---------------- */
    .search-row{display:flex;align-items:center;gap:8px;margin-top:10px}
    .search { flex:1; display:flex; align-items:center; gap:8px; background:linear-gradient(90deg,var(--accent),var(--accent-2)); padding:6px;border-radius:999px; }
    .search input{flex:1;border:0;background:transparent;padding:10px 12px;font-weight:600;color:#fff;outline:none;font-size:0.95rem}
    .search button{background:transparent;border:0;color:#fff;font-size:1.05rem;cursor:pointer;padding:6px}
    .controls { display:flex; gap:8px; align-items:center }
    .icon-btn{background:var(--glass);border:0;padding:8px;border-radius:10px;color:#fff;font-weight:700;cursor:pointer}

    /* ---------------- Nav (collapsible on mobile) ---------------- */
    nav.app-nav{margin-top:12px;background:rgba(0,0,0,0.03);border-radius:10px;padding:6px;display:flex;gap:8px;overflow:auto}
    nav.app-nav a{white-space:nowrap;text-decoration:none;color:var(--text-dark);padding:8px 10px;font-weight:700;border-radius:8px}
    nav.app-nav a.active{background:#fff;color:var(--accent)}
    /* small helper to allow horizontal scroll but prevent layout break */
    nav.app-nav::-webkit-scrollbar{height:6px}
    nav.app-nav::-webkit-scrollbar-thumb{background:rgba(0,0,0,0.12);border-radius:6px}

    /* ---------------- Hero (stacked on mobile) ---------------- */
    .hero{display:flex;flex-direction:column;gap:12px;margin-top:14px}
    .hero-card{background:var(--glass);border-radius:12px;padding:12px;color:#fff}
    .hero-card h2{font-family:'Montserrat';font-size:1.15rem;margin-bottom:6px}
    .hero-meta{font-size:0.9rem;color:rgba(255,255,255,0.95)}
    .hero-actions{display:flex;gap:8px;margin-top:10px;flex-wrap:wrap}
    .btn{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#fff;border:0;padding:10px 12px;border-radius:10px;font-weight:800;cursor:pointer}
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.12);color:#fff}

    /* ---------------- Compact events list for mobile ---------------- */
    .section-title{display:flex;align-items:center;justify-content:space-between;margin-top:16px;margin-bottom:8px}
    .section-title h3{font-family:'Montserrat';font-size:1rem}
    .events-list{display:flex;flex-direction:column;gap:12px}
    .event-item{display:flex;gap:10px;align-items:flex-start;background:#fff;border-radius:10px;padding:10px;box-shadow:0 8px 24px rgba(0,0,0,0.06);color:var(--text-dark)}
    .event-thumb{width:98px;height:70px;border-radius:8px;flex:0 0 98px;object-fit:cover}
    .event-body{flex:1}
    .event-title{font-weight:700;font-size:0.98rem;margin-bottom:6px}
    .event-meta{display:flex;gap:8px;align-items:center;font-size:0.85rem;color:var(--muted);margin-bottom:8px}
    .price{font-weight:800;color:var(--accent)}
    .event-actions{display:flex;gap:8px}

    /* ---------------- Popular horizontal (small cards) ---------------- */
    .popular-row{display:flex;gap:10px;overflow:auto;padding-bottom:6px}
    .popular-card{min-width:170px;background:#fff;border-radius:10px;padding:8px;box-shadow:0 6px 18px rgba(0,0,0,0.06);color:var(--text-dark)}

    /* ---------------- Filters modal (mobile friendly) ---------------- */
    .filters-btn{display:flex;justify-content:center;margin-top:12px}
    .filters-btn button{width:100%;padding:10px;border-radius:10px;border:0;background:#fff;color:var(--accent);font-weight:800}
    .filters-modal{position:fixed;inset:0;background:rgba(0,0,0,0.6);display:none;align-items:flex-end;z-index:1500}
    .filters-panel{background:#fff;border-top-left-radius:14px;border-top-right-radius:14px;padding:14px;max-height:78vh;overflow:auto}

    /* ---------------- Testimonials, newsletter, faq ---------------- */
    .testimonials{margin-top:14px;display:flex;flex-direction:column;gap:10px}
    .testimonial{background:#fff;padding:12px;border-radius:10px;box-shadow:0 6px 18px rgba(0,0,0,0.06);color:var(--text-dark)}
    .newsletter{background:#fff;margin-top:14px;padding:12px;border-radius:10px;display:flex;gap:8px;align-items:center}
    .newsletter input{flex:1;padding:10px;border-radius:8px;border:1px solid rgba(0,0,0,0.06)}
    .faq .faq-item{background:#fff;padding:12px;border-radius:10px;margin-top:8px;cursor:pointer}

    /* ---------------- Footer ---------------- */
    footer.app-footer{margin-top:18px;padding:12px;text-align:center;color:var(--muted);font-size:0.9rem}

    /* ---------------- Modals & cookie ---------------- */
    .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.65);display:none;align-items:center;justify-content:center;z-index:1600}
    .modal{background:#fff;padding:12px;border-radius:10px;width:92%;max-width:520px}
    .cookie-banner{position:fixed;left:12px;right:12px;bottom:12px;background:#fff;padding:12px;border-radius:10px;box-shadow:0 12px 40px rgba(0,0,0,0.2);display:none;align-items:center;justify-content:space-between;gap:8px;z-index:1700}

    /* ---------------- Small responsive tweaks ---------------- */
    @media(min-width:700px){
      .hero{flex-direction:row}
      .hero-card{flex:1}
      .popular-row{padding:8px 0}
      nav.app-nav{justify-content:flex-start}
      .app{padding:20px 28px}
    }
  </style>
</head>
<body>
  <div class="app" role="application">

    <!-- Header -->
    <header class="app-header" role="banner">
      <div style="display:flex;align-items:center;gap:10px">
        <div class="hamburger" id="hamburger" aria-label="Ouvrir le menu" aria-expanded="false" role="button" tabindex="0">
          <span></span><span></span><span></span>
        </div>
        <div class="brand" aria-hidden="false">
          <img src="https://i.postimg.cc/KjLQ8q3b/Background-Eraser.png" alt="Logo Marketlify">
          <h1>Marketlify</h1>
        </div>
      </div>

      <div style="display:flex;gap:8px;align-items:center">
        <button id="accountBtn" class="icon-btn" aria-label="Mon compte">Mon compte</button>
      </div>
    </header>

    <!-- Search & small controls -->
    <div class="search-row" role="search" aria-label="Recherche Marketlify">
      <div class="search" style="flex:1">
        <input id="searchInput" list="searchSuggestions" placeholder="Rechercher artiste, ville, √©v√©nement..." aria-label="Rechercher">
        <datalist id="searchSuggestions">
          <option value="Maitre Gims - Paris"></option>
          <option value="Rock Festival Lyon"></option>
          <option value="Th√©√¢tre Com√©die - Marseille"></option>
        </datalist>
        <button id="searchBtn" aria-label="Lancer la recherche">üîç</button>
      </div>
      <div class="controls">
        <button id="filtersOpen" class="icon-btn" aria-haspopup="dialog" aria-controls="filtersModal">Filtres</button>
        <button id="themeToggle" class="icon-btn" aria-pressed="false" title="Mode sombre">üåô</button>
      </div>
    </div>

    <!-- Nav tags (horizontal scroll if needed) -->
    <nav class="app-nav" role="navigation" aria-label="Navigation principale" id="mainNav">
      <a href="#home" class="active">Accueil</a>
      <a href="#promos">Promotions</a>
      <a href="#nouvelles">Nouveaut√©s</a>
      <a href="#categories">Cat√©gories</a>
      <a href="#contact">Contact</a>
    </nav>

    <!-- HERO -->
    <main id="home" class="hero" role="main" aria-label="Section principale">
      <div class="hero-card" aria-labelledby="heroTitle">
        <h2 id="heroTitle">Billets de concerts & spectacles ‚Äî en 2 clics</h2>
        <div class="hero-meta">Recherche intelligente, promos exclusives, billetterie instantan√©e.</div>
        <div class="hero-actions">
          <button id="discoverBtn" class="btn">üé´ Parcourir les billets</button>
          <button id="subscribeBtn" class="btn ghost">‚úâÔ∏è Newsletter</button>
          <div style="display:flex;align-items:center;gap:8px;margin-left:auto">
            <span style="background:#fff;color:var(--accent);padding:6px 8px;border-radius:8px;font-weight:800">Paiement s√©curis√©</span>
          </div>
        </div>

        <!-- Popular strip (compact) -->
        <div style="margin-top:12px">
          <div style="display:flex;align-items:center;justify-content:space-between">
            <strong style="color:#fff">Tendances</strong>
            <small style="color:rgba(255,255,255,0.9);font-weight:700" id="trendingCount">0</small>
          </div>
          <div class="popular-row" id="popularList" aria-label="√âv√©nements populaires" tabindex="0" style="margin-top:8px"></div>
        </div>
      </div>

      <aside class="hero-right hero-card" style="background:#fff;color:var(--text-dark)">
        <div style="font-weight:800" id="nextEventTitle">Maitre Gims ‚Äî Paris La D√©fense Arena</div>
        <div style="color:var(--muted);margin-top:6px;font-size:0.9rem">Samedi 20 d√©cembre 2025 ‚Äî Paris</div>
        <div style="margin-top:8px;font-weight:900;color:var(--accent)" id="countdown">Chargement‚Ä¶</div>
        <div style="display:flex;gap:8px;margin-top:10px">
          <button class="btn" id="buyNow">Acheter</button>
          <button class="btn ghost" id="addCalendar">Ajouter au calendrier</button>
        </div>
      </aside>
    </main>

    <!-- Filters button (opens modal) -->
    <div class="filters-btn"><button id="filtersOpenPrimary">Afficher les filtres</button></div>

    <!-- Events list (mobile stacked) -->
    <section aria-label="Liste d'√©v√©nements" style="margin-top:12px">
      <div class="section-title">
        <h3>√âv√©nements</h3>
        <div style="display:flex;gap:8px;align-items:center">
          <select id="sortSelect" aria-label="Trier" style="padding:8px;border-radius:8px;border:1px solid rgba(0,0,0,0.08)">
            <option value="soon">Date proche</option>
            <option value="price-asc">Prix ‚Üë</option>
            <option value="price-desc">Prix ‚Üì</option>
            <option value="popular">Popularit√©</option>
          </select>
        </div>
      </div>

      <div id="eventsGrid" class="events-list" aria-live="polite"></div>
    </section>

    <!-- Testimonials -->
    <section class="testimonials" aria-label="Avis clients">
      <div class="testimonial"><strong>‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</strong><div style="margin-top:6px;font-weight:700">Super exp√©rience ! Billets re√ßus en 2 minutes.</div><div style="color:var(--muted);font-size:0.85rem;margin-top:6px">‚Äî Clara, Paris</div></div>
      <div class="testimonial"><strong>‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ</strong><div style="margin-top:6px;font-weight:700">Bonne interface, service client r√©actif.</div><div style="color:var(--muted);font-size:0.85rem;margin-top:6px">‚Äî Ahmed, Lyon</div></div>
    </section>

    <!-- Newsletter -->
    <section class="newsletter" aria-label="Inscription newsletter" style="margin-top:12px">
      <input id="newsletterEmail" type="email" placeholder="Ton email">
      <button id="newsletterBtn" class="btn">S'inscrire</button>
    </section>

    <!-- FAQ -->
    <section class="faq" style="margin-top:12px" aria-label="FAQ">
      <h3 style="margin-bottom:8px">FAQ</h3>
      <div class="faq-item" data-open="false">Comment recevoir mon billet ?<div class="muted" style="display:none;margin-top:8px">Ton billet arrive par email en PDF avec QR-code. Montre-le √† l'entr√©e.</div></div>
      <div class="faq-item" data-open="false">Politique de remboursement<div class="muted" style="display:none;margin-top:8px">Consulte les CGV en bas du site pour les conditions exactes.</div></div>
    </section>

    <!-- Footer -->
    <footer class="app-footer" style="margin-top:18px">
      <div style="font-weight:700">¬© 2025 Marketlify</div>
      <div style="color:var(--muted);margin-top:6px"><a href="#legal">Mentions l√©gales</a> ‚Ä¢ <a href="#cgv">CGV</a> ‚Ä¢ <a href="#privacy">Politique de confidentialit√©</a></div>
      <div style="color:var(--muted);margin-top:6px;font-size:12px">Site maquette ‚Äî connecter paiements & serveurs pour production.</div>
    </footer>
  </div>

  <!-- Filters Modal (mobile) -->
  <div id="filtersModal" class="filters-modal" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="filters-panel" role="document">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <strong>Filtres</strong>
        <button id="filtersClose" style="background:transparent;border:0;font-weight:800;cursor:pointer">‚úï</button>
      </div>
      <div style="margin-top:12px">
        <label style="font-weight:700">Ville</label>
        <input id="city" placeholder="Ex: Paris" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(0,0,0,0.06);margin-top:8px">
      </div>
      <div style="margin-top:12px">
        <label style="font-weight:700">Cat√©gorie</label>
        <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:8px">
          <button class="chip active" data-cat="">Tous</button>
          <button class="chip" data-cat="concert">Concerts</button>
          <button class="chip" data-cat="theatre">Th√©√¢tre</button>
          <button class="chip" data-cat="comedy">Humour</button>
          <button class="chip" data-cat="festival">Festival</button>
        </div>
      </div>
      <div style="margin-top:12px;display:flex;gap:8px">
        <input id="minPrice" type="number" placeholder="Min ‚Ç¨" style="flex:1;padding:10px;border-radius:8px;border:1px solid rgba(0,0,0,0.06)">
        <input id="maxPrice" type="number" placeholder="Max ‚Ç¨" style="flex:1;padding:10px;border-radius:8px;border:1px solid rgba(0,0,0,0.06)">
      </div>
      <div style="display:flex;gap:8px;margin-top:12px">
        <button id="applyFilters" class="btn" style="flex:1">Appliquer</button>
        <button id="resetFilters" class="btn ghost" style="flex:1">R√©initialiser</button>
      </div>
      <div style="margin-top:8px;color:var(--muted);font-size:13px">Astuce : tu peux trier par date ou popularit√© depuis la liste.</div>
    </div>
  </div>

  <!-- Modal: purchase simulation -->
  <div id="modalBackdrop" class="modal-backdrop" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal" role="document">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <strong id="modalTitle">Achat</strong>
        <button id="modalClose" style="background:transparent;border:0;font-weight:800;cursor:pointer">‚úï</button>
      </div>
      <div id="modalBody" style="margin-top:8px">Charger...</div>
    </div>
  </div>

  <!-- Stock popup (subtle) -->
  <div id="stockPopup" class="modal-backdrop" style="display:none;align-items:flex-end;justify-content:center;z-index:1550">
    <div class="modal" style="border-radius:12px;max-width:420px">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <strong>Stock limit√©</strong>
        <button data-close-stock style="background:transparent;border:0;font-weight:800;cursor:pointer">‚úï</button>
      </div>
      <div style="margin-top:8px">Il ne reste plus que <strong id="lowStock">6</strong> places pour cet √©v√©nement.</div>
      <div style="display:flex;gap:8px;margin-top:10px;justify-content:flex-end">
        <button class="btn ghost" data-close-stock>Plus tard</button>
        <button id="buyNowFromStock" class="btn">Acheter</button>
      </div>
    </div>
  </div>

  <!-- Cookie banner -->
  <div id="cookieBanner" class="cookie-banner" role="dialog" aria-live="polite">
    <div style="flex:1">
      <strong>Nous utilisons des cookies</strong>
      <div class="muted" style="font-size:13px;margin-top:4px">Pour am√©liorer ton exp√©rience et t'envoyer des offres.</div>
    </div>
    <div style="display:flex;gap:8px">
      <button id="acceptCookies" class="btn">Accepter</button>
      <button id="manageCookies" class="btn ghost">G√©rer</button>
    </div>
  </div>

  <!-- Minimal structured data -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"Organization",
    "name":"Marketlify",
    "url":"https://marketlify-shopping.netlify.app",
    "logo":"https://i.postimg.cc/KjLQ8q3b/Background-Eraser.png"
  }
  </script>

  <!-- ---------------- JS interactive (mobile-optimized) ---------------- -->
  <script>
    /* ---------- Sample events dataset (same as before) ---------- */
    const EVENTS = [
      {id:1,title:"Maitre Gims - Paris La D√©fense",city:"Paris",date:"2025-12-20T20:00:00",price:45,category:"concert",img:"https://picsum.photos/seed/gims/600/400",pop:95,stock:12,desc:"Concert hip-hop & pop."},
      {id:2,title:"Rock Night - Lyon",city:"Lyon",date:"2025-10-02T19:00:00",price:30,category:"concert",img:"https://picsum.photos/seed/rock/600/400",pop:80,stock:4,desc:"Les meilleurs groupes locaux."},
      {id:3,title:"Th√©√¢tre Com√©die - Marseille",city:"Marseille",date:"2025-09-15T20:30:00",price:25,category:"theatre",img:"https://picsum.photos/seed/theatre/600/400",pop:70,stock:20,desc:"Pi√®ce comique familiale."},
      {id:4,title:"Festival Jazz - Bordeaux",city:"Bordeaux",date:"2025-11-10T18:00:00",price:60,category:"festival",img:"https://picsum.photos/seed/jazz/600/400",pop:85,stock:50,desc:"3 jours de jazz."},
      {id:5,title:"Stand-up Night - Toulouse",city:"Toulouse",date:"2025-09-25T21:00:00",price:20,category:"comedy",img:"https://picsum.photos/seed/comedy/600/400",pop:65,stock:6,desc:"Soir√©e stand-up"}
    ];

    /* --------- Helpers --------- */
    const $ = s => document.querySelector(s);
    const $$ = s => Array.from(document.querySelectorAll(s));

    /* ---------- Render popular strip (mobile) ---------- */
    function renderPopular(){
      const el = $('#popularList'); el.innerHTML = '';
      const top = EVENTS.slice().sort((a,b)=>b.pop-a.pop).slice(0,6);
      $('#trendingCount').textContent = top.length;
      top.forEach(e=>{
        const d = document.createElement('div'); d.className='popular-card';
        d.innerHTML = `<img src="${e.img}" alt="${e.title}" style="width:100%;height:80px;object-fit:cover;border-radius:6px"><div style="font-weight:800;margin-top:8px">${e.title}</div><div style="color:var(--muted);font-size:12px;margin-top:6px">${new Date(e.date).toLocaleString()}</div><div style="margin-top:8px"><button class="btn" data-id="${e.id}" style="padding:8px 10px">Voir</button></div>`;
        el.appendChild(d);
      });
    }

    /* ---------- Render events list (stacked mobile) ---------- */
    function renderEvents(list){
      const grid = $('#eventsGrid'); grid.innerHTML = '';
      if(!list || list.length===0){ grid.innerHTML = '<div class="muted">Aucun √©v√©nement trouv√©.</div>'; return; }
      list.forEach(e=>{
        const item = document.createElement('article'); item.className='event-item';
        item.innerHTML = `<img class="event-thumb" src="${e.img}" alt="${e.title}" loading="lazy"><div class="event-body"><div class="event-title">${e.title}</div><div class="event-meta"><span>${e.city}</span><span>‚Ä¢</span><span>${new Date(e.date).toLocaleDateString()}</span></div><div style="display:flex;justify-content:space-between;align-items:center"><div class="price">${e.price}‚Ç¨</div><div class="event-actions"><button class="btn" data-id="${e.id}">Voir</button></div></div></div>`;
        grid.appendChild(item);
      });
    }

    /* ---------- Initial render ---------- */
    renderPopular();
    renderEvents(EVENTS);

    /* ---------- Filters: open modal ---------- */
    const filtersModal = $('#filtersModal');
    $('#filtersOpen')?.addEventListener('click', ()=>{ filtersModal.style.display='flex'; filtersModal.setAttribute('aria-hidden','false'); $('#hamburger').setAttribute('aria-expanded','true'); });
    $('#filtersOpenPrimary')?.addEventListener('click', ()=>{ filtersModal.style.display='flex'; filtersModal.setAttribute('aria-hidden','false'); });
    $('#filtersClose')?.addEventListener('click', ()=>{ filtersModal.style.display='none'; filtersModal.setAttribute('aria-hidden','true'); });

    /* ---------- Chips behaviour ---------- */
    $$('.chip').forEach(btn=>{
      btn.addEventListener('click', ()=> {
        $$('.chip').forEach(c=>c.classList.remove('active'));
        btn.classList.add('active');
      });
    });

    /* ---------- Apply / Reset filters ---------- */
    $('#applyFilters')?.addEventListener('click', ()=> {
      applyFilters();
      filtersModal.style.display='none';
      filtersModal.setAttribute('aria-hidden','true');
    });
    $('#resetFilters')?.addEventListener('click', ()=> {
      $('#city').value=''; $('#minPrice').value=''; $('#maxPrice').value=''; $$('.chip').forEach(c=>c.classList.remove('active')); $$('.chip')[0].classList.add('active');
      renderEvents(EVENTS);
      filtersModal.style.display='none';
    });

    function applyFilters(){
      const q = ($('#searchInput').value || '').trim().toLowerCase();
      const city = ($('#city').value || '').trim().toLowerCase();
      const cat = ($$('.chip.active')[0]?.dataset.cat) || '';
      const min = parseFloat($('#minPrice').value) || 0;
      const max = parseFloat($('#maxPrice').value) || Infinity;
      const sort = $('#sortSelect').value || 'soon';
      let res = EVENTS.slice().filter(e=>{
        if(q && !((e.title+e.desc).toLowerCase().includes(q))) return false;
        if(city && !e.city.toLowerCase().includes(city)) return false;
        if(cat && e.category !== cat) return false;
        if(e.price < min || e.price > max) return false;
        return true;
      });
      if(sort==='price-asc') res.sort((a,b)=>a.price-b.price);
      if(sort==='price-desc') res.sort((a,b)=>b.price-a.price);
      if(sort==='soon') res.sort((a,b)=> new Date(a.date)-new Date(b.date));
      if(sort==='popular') res.sort((a,b)=> b.pop-a.pop);
      renderEvents(res);
    }

    /* ---------- Delegated clicks: open modal / share ---------- */
    document.body.addEventListener('click', (ev)=>{
      const t = ev.target;
      if(t.matches('button[data-id]')) openPurchaseModal(parseInt(t.dataset.id));
      if(t.matches('[data-close-stock]')) closeStockPopup();
      if(t.matches('#buyNowFromStock')) openPurchaseModal(EVENTS[0].id);
      if(t.matches('#searchBtn')) applyFilters();
      if(t.matches('#discoverBtn')) { document.getElementById('categories')?.scrollIntoView({behavior:'smooth'}); }
      if(t.matches('#subscribeBtn')) { document.getElementById('newsletterEmail').focus(); }
    });

    /* ---------- Purchase modal ---------- */
    const modalBackdrop = $('#modalBackdrop');
    function openPurchaseModal(id){
      const ev = EVENTS.find(x=>x.id===id); if(!ev) return;
      $('#modalTitle').textContent = `Acheter ‚Äî ${ev.title}`;
      $('#modalBody').innerHTML = `<p style="margin:6px 0">${ev.title} ‚Äî ${new Date(ev.date).toLocaleString()}</p><label>Quantit√©</label><select id="qty" style="margin-top:6px;padding:8px;border-radius:8px"><option>1</option><option>2</option><option>3</option></select><div style="margin-top:10px;display:flex;gap:8px;justify-content:flex-end"><button id="cancelBuy" class="btn ghost">Annuler</button><button id="confirmBuy" class="btn">Confirmer</button></div>`;
      modalBackdrop.style.display='flex'; modalBackdrop.setAttribute('aria-hidden','false');
      $('#cancelBuy').onclick = ()=> { modalBackdrop.style.display='none'; };
      $('#confirmBuy').onclick = ()=> { alert('Achat simul√© ‚Äî merci (simulation).'); modalBackdrop.style.display='none'; };
      $('#modalClose').onclick = ()=> { modalBackdrop.style.display='none'; };
    }

    /* ---------- Countdown (for first event) ---------- */
    function startCountdown(iso, elID){
      const el = document.getElementById(elID);
      if(!el) return;
      function update(){
        const diff = new Date(iso) - new Date();
        if(diff <= 0){ el.textContent = '√âv√©nement en cours / termin√©'; return; }
        const d = Math.floor(diff/86400000);
        const h = Math.floor((diff%86400000)/3600000);
        const m = Math.floor((diff%3600000)/60000);
        const s = Math.floor((diff%60000)/1000);
        el.textContent = `${d}j ${h}h ${m}m ${s}s`;
      }
      update(); setInterval(update,1000);
    }
    startCountdown(EVENTS[0].date, 'countdown');

    /* ---------- Cookie banner ---------- */
    function showCookie(){
      if(localStorage.getItem('marketlifyCookies') !== 'accepted'){
        $('#cookieBanner').style.display = 'flex';
      }
    }
    $('#acceptCookies').addEventListener('click', ()=>{ localStorage.setItem('marketlifyCookies','accepted'); $('#cookieBanner').style.display='none'; });
    $('#manageCookies').addEventListener('click', ()=> alert('G√©rer les cookies (simulation)'));
    showCookie();

    /* ---------- Stock popup on load (if low stock) ---------- */
    function showLowStock(){
      const low = EVENTS.find(e => e.stock > 0 && e.stock <= 6);
      if(low){
        $('#lowStock').textContent = low.stock;
        document.getElementById('stockPopup').style.display = 'flex';
      }
    }
    function closeStockPopup(){ document.getElementById('stockPopup').style.display = 'none'; }
    showLowStock();

    /* ---------- Newsletter ---------- */
    $('#newsletterBtn').addEventListener('click', ()=>{
      const email = ($('#newsletterEmail').value || '').trim();
      if(!email){ alert('Entre ton e-mail'); return; }
      alert(`Inscription simul√©e ‚Äî ${email} ajout√©(e) √† la newsletter.`);
      $('#newsletterEmail').value = '';
    });

    /* ---------- FAQ toggle ---------- */
    $$('.faq .faq-item').forEach(item=>{
      item.addEventListener('click', ()=>{
        const open = item.getAttribute('data-open') === 'true';
        const detail = item.querySelector('.muted');
        if(detail) detail.style.display = open ? 'none' : 'block';
        item.setAttribute('data-open', (!open).toString());
      });
    });

    /* ---------- Theme toggle (light/dark simplified) ---------- */
    const themeBtn = $('#themeToggle');
    let dark = false;
    themeBtn.addEventListener('click', ()=>{
      dark = !dark;
      if(dark){
        document.body.style.background = 'linear-gradient(180deg, rgba(7,11,20,0.9), rgba(2,6,12,0.9))';
        document.documentElement.style.setProperty('--text-dark','#fff');
        themeBtn.textContent = '‚òÄÔ∏è';
        themeBtn.setAttribute('aria-pressed','true');
      } else {
        document.body.style.background = 'linear-gradient(180deg, rgba(245,87,2,0.12), rgba(148,201,233,0.08))';
        document.documentElement.style.setProperty('--text-dark','#0f1722');
        themeBtn.textContent = 'üåô';
        themeBtn.setAttribute('aria-pressed','false');
      }
    });

    /* ---------- Hamburger menu (opens filters as quick menu) ---------- */
    $('#hamburger').addEventListener('click', ()=>{
      const expanded = $('#hamburger').getAttribute('aria-expanded') === 'true';
      $('#hamburger').setAttribute('aria-expanded', (!expanded).toString());
      if(!expanded){
        // quick open filters modal for small devices
        filtersModal.style.display='flex'; filtersModal.setAttribute('aria-hidden','false');
      } else {
        filtersModal.style.display='none'; filtersModal.setAttribute('aria-hidden','true');
      }
    });

    /* ---------- Delegation: close modals on ESC ---------- */
    document.addEventListener('keydown', (e)=>{
      if(e.key === 'Escape'){
        modalBackdrop.style.display='none';
        filtersModal.style.display='none';
        document.getElementById('stockPopup').style.display='none';
      }
    });

    /* ---------- Sort select change ---------- */
    $('#sortSelect').addEventListener('change', ()=> applyFilters());

    /* ---------- Smooth focus for accessibility ---------- */
    ['searchInput','discoverBtn','subscribeBtn','buyNow'].forEach(id=>{
      const el = document.getElementById(id); if(el) el.tabIndex = 0;
    });

    /* ---------- On load: minor UX ---------- */
    window.addEventListener('load', ()=> {
      // Pre-fill trending and events are rendered above
      // Small console log for debugging
      console.info('Marketlify mobile UI ready ‚Äî events loaded:', EVENTS.length);
    });
  </script>
</body>
</html>